<% if %w(new create).include?(controller.action_name)
     title(t('registrations.new.title'))
   else
     title(t('registrations.edit.title'))
   end
%>

<div class="panel panel-default">
  <div class="panel-heading">
    <h2 class="panel-title"><%= Date.current.year.to_s + "-" + Date.current.next_year.year.to_s %></h2>
  </div>
  <%= simple_form_for [@student, @registration] do |f| %>

      <table class="table table-hover table-border">
        <thead>
            <th></th>
            <th><%= t('mongoid.attributes.course.title') %></th>
            <th class="text-center"><%= t('mongoid.attributes.course.semester') %></th>
            <th><%= t('mongoid.attributes.course.course_type') %></th>
            <th class="text-center"><%= t('mongoid.attributes.course.ects') %></th>
            <th class="text-center"><%= t('mongoid.attributes.course.hours') %></th>
        </thead>
        <tbody>
        <%= f.association :courses do |b| %>
            <% @courses.each do |c| %>
                <% if c.has_courses? %>
                    <% c.courses.each do |child| %>
                        <tr>
                          <td class="text-center"><%= f.input_field :course_ids, collection: child, label_method: lambda{|obj| ''}, as: :check_boxes, class:'icheck' %></td>
                          <td><%= "#{child.title} (#{t("enumerize.course.course_part.#{child.course_part}")})" %></td>
                          <td class="text-center"><%= c.semester %></td>
                          <td><%= t("enumerize.course.course_type.#{c.course_type}") %></td>
                          <td class="text-center"><%= number_to_percentage child.percent, precision: 0 %></td>
                          <td class="text-center"><%= child.hours %></td>
                        </tr>
                    <% end %>
                <% else %>
                    <tr>
                      <td class="text-center"><%= f.input_field :course_ids, collection: c, label_method: lambda{|obj| ''}, as: :check_boxes, class:'icheck' %></td>
                      <td><%= c.title %></td>
                      <td class="text-center"><%= c.semester %></td>
                      <td><%= t("enumerize.course.course_type.#{c.course_type}") %></td>
                      <td class="text-center"><%= c.ects %></td>
                      <td class="text-center"><%= c.hours %></td>
                    </tr>
                <% end %>
            <% end %>
        <% end %>
        </tbody>
      </table>


  <div class="panel-footer">
        <%= f.button :submit, class:'btn-success' %>
        <%= cancel_btn(student_registrations_path(@registration.student)) %>
    <% end %>
  </div><!--//panel-footer-->
</div><!--//panel-->



